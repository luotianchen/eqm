<div>
  <h3 class="title">入库通知单生成</h3>
</div>
<nz-tabset>
  <nz-tab nzTitle="按日期查询">
    <form nz-form [formGroup]="validateForm" class="ant-advanced-search-form">
      <div nz-row [nzGutter]="24">
        <div nz-col [nzSpan]="8">
          <nz-form-item>
            <nz-form-label [nzSm]="6" [nzFor]="matlcode">材料代码</nz-form-label>
            <nz-form-control [nzSm]="14">
              <input nz-input placeholder="材料代码" formControlName="matlcode" name="matlcode" id="matlcode" >
              <nz-form-explain *ngIf="validateForm.get('matlcode').dirty && validateForm.get('matlcode').errors">
                材料代码不能为空！
              </nz-form-explain>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="8">
          <nz-form-item>
            <nz-form-label [nzSm]="6" [nzFor]="year">入库年份</nz-form-label>
            <nz-form-control [nzSm]="14">
              <nz-input-number [nzPlaceHolder]="'入库年份'" [nzMin]="1990" [nzMax]="thisyear" [nzStep]="1" formControlName="year" name="year" id="year" style="width: 100%"></nz-input-number>
              <nz-form-explain *ngIf="validateForm.get('year').dirty && validateForm.get('year').errors">
                入库年份不能为空！
              </nz-form-explain>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="8">
          <nz-form-item>
            <nz-form-label [nzSm]="6" [nzFor]="month">入库月份</nz-form-label>
            <nz-form-control [nzSm]="14">
              <nz-input-number [nzPlaceHolder]="'入库月份'" [nzMin]="1" [nzMax]="12" [nzStep]="1" formControlName="month" name="month" id="month" style="width: 100%"></nz-input-number>
              <nz-form-explain *ngIf="validateForm.get('month').dirty && validateForm.get('month').errors">
                入库月份不能为空！
              </nz-form-explain>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="8">
          <button nz-button [nzType]="'primary'" (click)="searchDataByMatlcode()">查询</button>
        </div>
      </div>
    </form>
  </nz-tab>
  <nz-tab nzTitle="通过入库编号查询">
    <form nz-form [formGroup]="validateForm2" class="ant-advanced-search-form">
      <div nz-row [nzGutter]="24">
        <div nz-col [nzSpan]="8">
          <nz-form-item>
            <nz-form-label [nzSm]="6" [nzFor]="codedmarking">入库编号</nz-form-label>
            <nz-form-control [nzSm]="14">
              <input nz-input placeholder="入库编号" formControlName="codedmarking" name="codedmarking" id="codedmarking" >
              <nz-form-explain *ngIf="validateForm2.get('codedmarking').dirty && validateForm2.get('codedmarking').errors">
                入库编号不能为空！
              </nz-form-explain>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="8">
          <button nz-button [nzType]="'primary'" (click)="searchDataByCodedmarking()">查询</button>
        </div>
      </div>
    </form>
  </nz-tab>
</nz-tabset>
<div  *ngIf="dataSet.length > 0 && mode == 1" #print>
  <p style="margin-bottom: 20px;margin-top: 20px">
  <essence-ng2-print
    [mode]="'iframe'"
    [popTitle]="'入库通知单'"
    [btnText]="'打印通知单'"
    [printHTML]="print"
    [showBtn]="printBtnBoolean"
    [btnClass]="{'ant-btn':true}"
    (click)="beforePrint()"
    (printComplete)="printComplete()">
  </essence-ng2-print>
  <button
    nz-button
    nz-popover
    *ngIf="printBtnBoolean"
    nzType="primary"
    nzTitle="注意事项"
    nzContent="请在打印页面，点击更多设置-边距-最小值。"
    nzShape="circle"
    style="margin-left: 20px;margin-top: 4px">
    <i nz-icon type="question-circle" theme="outline"></i>
  </button>
  </p>
  <div *ngFor="let item of dataSet;let i = index">
    <iframe id="{{'a'+i}}" [src]="sanitizer.bypassSecurityTrustResourceUrl('../assets/report/cailiaoyanshourukutongzhidan.html?frameId=a'+i)" style="width:830px;height:1120px;border: none;"
            [attr.data-matlname]="item.matlname"
            [attr.data-designation]="item.designation"
            [attr.data-codedmarking]="item.codedmarking"
            [attr.data-spec]="item.spec"
            [attr.data-qty]="item.qty"
            [attr.data-warrantyno]="item.warrantyno"
            [attr.data-matlstand]="item.matlstand"
            [attr.data-heatbatchno]="item.heatbatchno"
            [attr.data-warrantysitu]="item.warrantysitu"
            [attr.data-millunit]="item.millunit"
            [attr.data-supplier]="item.supplier"
            [attr.data-dimension]="item.dimension"
            [attr.data-indate]="item.indate"
            [attr.data-modelstand]="item.modelstand"
            [attr.data-heatcondi]="item.heatcondi"
            [attr.data-pack]="item.pack"
            [attr.data-humisitu]="item.humisitu"
            [attr.data-coating]="item.coating"
            [attr.data-rustsitu]="item.rustsitu"
            [attr.data-eccentricity]="item.eccentricity"
            [attr.data-packcheck]="item.packcheck"
            [attr.data-rustsitu1]="item.rustsitu1"
            [attr.data-diamtest]="item.diamtest"
            [attr.data-packcheck1]="item.packcheck1"
            [attr.data-humisitu1]="item.humisitu1"
            [attr.data-graincheck]="item.graincheck"
            [attr.data-user]="item.user"
            [attr.data-audit_user]="item.audit_user"
            ></iframe>
  </div>
</div>

<div  *ngIf="dataSet.length > 0 && mode == 2" #print2>
  <p style="margin-bottom: 20px;margin-top: 20px">
  <essence-ng2-print
    [mode]="'iframe'"
    [popTitle]="'入库通知单'"
    [btnText]="'打印通知单'"
    [printHTML]="print2"
    [showBtn]="printBtnBoolean"
    [btnClass]="{'ant-btn':true}"
    (click)="beforePrint()"
    (printComplete)="printComplete()">
  </essence-ng2-print>
  <button
    nz-button
    nz-popover
    *ngIf="printBtnBoolean"
    nzType="primary"
    nzTitle="注意事项"
    nzContent="请在打印页面，点击更多设置-边距-最小值。"
    nzShape="circle"
    style="margin-left: 20px;margin-top: 4px">
    <i nz-icon type="question-circle" theme="outline"></i>
  </button>
  </p>
  <div *ngFor="let item of dataSet;let i = index">
    <iframe id="{{'b'+i}}" [src]="sanitizer.bypassSecurityTrustResourceUrl('../assets/report/waigoujianyanshourukutongzhidan.html?frameId=b'+i)" style="width:830px;height:1120px;border: none;"
            [attr.data-matlname]="item.matlname"
            [attr.data-designation]="item.designation"
            [attr.data-codedmarking]="item.codedmarking"
            [attr.data-spec]="item.spec"
            [attr.data-qty]="item.qty"
            [attr.data-warrantyno]="item.warrantyno"
            [attr.data-matlstand]="item.matlstand"
            [attr.data-heatbatchno]="item.heatbatchno"
            [attr.data-warrantysitu]="item.warrantysitu"
            [attr.data-millunit]="item.millunit"
            [attr.data-supplier]="item.supplier"
            [attr.data-dimension]="item.dimension"
            [attr.data-indate]="item.indate"
            [attr.data-modelstand]="item.modelstand"
            [attr.data-heatcondi]="item.heatcondi"
            [attr.data-pack]="item.pack"
            [attr.data-humisitu]="item.humisitu"
            [attr.data-coating]="item.coating"
            [attr.data-rustsitu]="item.rustsitu"
            [attr.data-eccentricity]="item.eccentricity"
            [attr.data-packcheck]="item.packcheck"
            [attr.data-rustsitu1]="item.rustsitu1"
            [attr.data-diamtest]="item.diamtest"
            [attr.data-packcheck1]="item.packcheck1"
            [attr.data-humisitu1]="item.humisitu1"
            [attr.data-graincheck]="item.graincheck"
            [attr.data-user]="item.user"
            [attr.data-audit_user]="item.audit_user"
    ></iframe>
  </div>
</div>


<div  *ngIf="dataSet.length > 0 && mode == 3" #print3>
  <p style="margin-bottom: 20px;margin-top: 20px">
  <essence-ng2-print
    [mode]="'iframe'"
    [popTitle]="'入库通知单'"
    [btnText]="'打印通知单'"
    [printHTML]="print3"
    [showBtn]="printBtnBoolean"
    [btnClass]="{'ant-btn':true}"
    (click)="beforePrint()"
    (printComplete)="printComplete()">
  </essence-ng2-print>
  <button
    nz-button
    nz-popover
    *ngIf="printBtnBoolean"
    nzType="primary"
    nzTitle="注意事项"
    nzContent="请在打印页面，点击更多设置-边距-最小值。"
    nzShape="circle"
    style="margin-left: 20px;margin-top: 4px">
    <i nz-icon type="question-circle" theme="outline"></i>
  </button>
  </p>
  <div *ngFor="let item of dataSet;let i = index">
    <iframe id="{{'c'+i}}" [src]="sanitizer.bypassSecurityTrustResourceUrl('../assets/report/hancaiyanshourukutongzhidan.html?frameId=c'+i)" style="width:830px;height:1120px;border: none;"
            [attr.data-matlname]="item.matlname"
            [attr.data-designation]="item.designation"
            [attr.data-codedmarking]="item.codedmarking"
            [attr.data-spec]="item.spec"
            [attr.data-qty]="item.qty"
            [attr.data-warrantyno]="item.warrantyno"
            [attr.data-matlstand]="item.matlstand"
            [attr.data-heatbatchno]="item.heatbatchno"
            [attr.data-warrantysitu]="item.warrantysitu"
            [attr.data-millunit]="item.millunit"
            [attr.data-supplier]="item.supplier"
            [attr.data-dimension]="item.dimension"
            [attr.data-indate]="item.indate"
            [attr.data-modelstand]="item.modelstand"
            [attr.data-heatcondi]="item.heatcondi"
            [attr.data-pack]="item.pack"
            [attr.data-humisitu]="item.humisitu"
            [attr.data-coating]="item.coating"
            [attr.data-rustsitu]="item.rustsitu"
            [attr.data-eccentricity]="item.eccentricity"
            [attr.data-packcheck]="item.packcheck"
            [attr.data-rustsitu1]="item.rustsitu1"
            [attr.data-diamtest]="item.diamtest"
            [attr.data-packcheck1]="item.packcheck1"
            [attr.data-humisitu1]="item.humisitu1"
            [attr.data-graincheck]="item.graincheck"
            [attr.data-user]="item.user"
            [attr.data-audit_user]="item.audit_user"
    ></iframe>
  </div>
</div>
